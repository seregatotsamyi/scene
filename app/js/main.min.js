import{animation,animationReviews,animationEnd}from"./anim.js";window.onload=function(){"use strict";animation();let r={phone:!1,rating:!1,ratingOld:!1,review:!1,wishes:!1,newProject:!1,showAll:!1},n=document.querySelectorAll(".raiting__label"),e=document.querySelectorAll(".raiting__input");e.forEach((e,t)=>{e.addEventListener("change",()=>(t=>{let a=["_current","_gold"];n.forEach(e=>e.classList.remove(...a)),n[t].classList.add("_current");for(let e=0;e<=t;e++)n[e].classList.add("_gold");r.rating=document.querySelector('input[name="raiting"]:checked').value,_()})(t))});let t=document.querySelectorAll(".new-project__input"),o=document.querySelectorAll(".new-project__label");t.forEach((e,t)=>{e.addEventListener("change",()=>(e=>{o.forEach(e=>{e.classList.remove("_checked"),e.classList.remove("_error")}),o[e].classList.add("_checked"),r.newProject=document.querySelector('input[name="new-project"]:checked').value,m(!1)})(t))});let a=document.querySelector('.form__input[name="phone"]'),i=document.querySelector('.form__input[name="reviews"]'),l=document.querySelector('.form__input[name="reviews-bad"]'),s=document.querySelector('.form__input[name="wishes"]'),c=(e,t,a)=>{3<e.length?(r.review=!0,a&&(t.classList.remove("_error"),t.classList.add("_complete"))):(r.review=!1,a&&(t.classList.add("_error"),t.classList.remove("_complete")))},d=(e,t)=>{3<e.length?(r.wishes=!0,t&&(s.classList.remove("_error"),s.classList.add("_complete"))):(r.wishes=!1,t&&(s.classList.remove("_complete"),s.classList.add("_error")))},m=e=>{let t=!0;for(var a in r)if(!1===r[a])switch(t=!1,a){case"review":c(i.value,i,e),c(l.value,l,e);break;case"wishes":d("",e);break;case"newProject":null===document.querySelector('input[name="new-project"]:checked')&&e&&o.forEach(e=>{e.classList.remove("_checked"),e.classList.add("_error")})}return t?$(".form__btn").addClass("_active"):$(".form__btn").removeClass("_active"),t};a&&a.addEventListener("input",()=>{var e,t;e=a.value,t=!0,16===e.length?(r.phone=!0,t&&(a.classList.remove("_error"),a.classList.add("_complete")),_()):(r.phone=!1,t&&(a.classList.remove("_complete"),a.classList.add("_error"))),m(!1)}),i&&i.addEventListener("change",()=>{c(i.value,i,!0),m(!1)}),l&&l.addEventListener("change",()=>{c(l.value,l,!0),m(!1)}),s&&s.addEventListener("change",()=>{d(s.value,!0),m(!1)});let _=()=>{r.phone&&r.rating&&!r.showAll&&(r.showAll=!0,r.ratingOld=r.rating,3<r.rating?($('.form__item-wrap[data-option="bed"]').hide(),$('.form__item-wrap[data-option="nice"]').fadeIn()):($('.form__item-wrap[data-option="nice"]').hide(),$('.form__item-wrap[data-option="bed"]').fadeIn()),animationReviews(),$(".form__item-wrap._end-anim").slideDown(),$(".form__btn").fadeIn(),animationEnd()),r.phone&&r.rating&&r.showAll&&(3<r.ratingOld&&r.rating<=3&&(r.ratingOld=r.rating,$('.form__item-wrap[data-option="nice"]').hide(),$('.form__item-wrap[data-option="bed"]').fadeIn(),animationReviews()),r.ratingOld<=3&&3<r.rating&&(r.ratingOld=r.rating,$('.form__item-wrap[data-option="bed"]').hide(),$('.form__item-wrap[data-option="nice"]').fadeIn(),animationReviews()))};$("#form").on("submit",function(e){e.preventDefault();var t;$(this).serialize();m(!0)?(alert("Отправка успешна"),3<r.rating?(t=i.value,e=a.value,localStorage.setItem("reviews_ls",t),localStorage.setItem("phone_ls",e),document.location.href="/thank.html"):document.location.href="/thank-two.html"):alert("Валидация")});let u=$(".body"),h=$("#toggle-menu"),p=$("#mobMenu");h.on("click",()=>{h.toggleClass("_active"),u.toggleClass("_fixed"),p.toggleClass("_open")})};